<!DOCTYPE HTML>
<html lang="en-US" >
    
    <head>
        
        <meta charset="UTF-8">
        <title>Parallelization | GenomeRunner</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 0.6.0">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <meta name="author" content="mdozmorov">
    
    
    <link rel="next" href="../server/serverFAQ.html" />
    
    
    <link rel="prev" href="../server/server.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../gitbook/style.css">


        
    <div class="book" data-github="mdozmorov/grdocs" data-level="6.3.1" data-basepath=".." data-revision="1405872601847">
    <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    
    <a href="https://github.com/mdozmorov/grdocs" target="_blank" class="btn pull-left home-bookmark" aria-label="GitHub home"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="btn-group btn-block">
        <button id="reduce-font-size" class="btn btn-default">A</button>
        <button id="enlarge-font-size" class="btn btn-default">A</button>
    </div>

    <ul class="list-group font-family-list">
        <li class="list-group-item" data-font="0">Serif</li>
        <li class="list-group-item" data-font="1">Sans</li>
    </ul>

    <div class="btn-group btn-group-xs btn-block color-theme-list">
        <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
    </div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    

    
    <a href="https://github.com/mdozmorov/grdocs/stargazers" target="_blank" class="btn pull-right count-star hidden-xs"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/mdozmorov/grdocs/watchers" target="_blank" class="btn pull-right count-watch hidden-xs"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../" >GenomeRunner</a>
    </h1>
</div>

    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        <li>
            <a href="https://github.com/mdozmorov" target="blank" class="author-link">About the author</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/mdozmorov/grdocs/issues" target="blank"class="issues-link">Questions and Issues</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/mdozmorov/grdocs/edit/master/server/serverParallel.md" target="blank" class="contribute-link">Edit and Contribute</a>
        </li>
        

	

        
        <li class="divider"></li>
        

        
    
        
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                         Introduction
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1" data-path="misc/Faq.html">
            
                
                    <a href="../misc/Faq.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         FAQ
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2" data-path="misc/definitions.html">
            
                
                    <a href="../misc/definitions.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         Definitions
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3" data-path="misc/newsAndUpdates.html">
            
                
                    <a href="../misc/newsAndUpdates.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         News and Updates
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4" data-path="installation/installation.html">
            
                
                    <a href="../installation/installation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                         Installation
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5" data-path="installation/uninstallation.html">
            
                
                    <a href="../installation/uninstallation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                         Uninstalling
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6" data-path="installation/modules.html">
            
                
                    <a href="../installation/modules.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                         Modules
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.1" data-path="dbcreator/dbcreator.html">
            
                
                    <a href="../dbcreator/dbcreator.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                         Dbcreator module
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.1.1" data-path="dbcreator/dbcreator_ucsc.html">
            
                
                    <a href="../dbcreator/dbcreator_ucsc.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.1.</b>
                        
                         dbcreator_ucsc
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.2" data-path="dbcreator/dbcreator_encodeDCC.html">
            
                
                    <a href="../dbcreator/dbcreator_encodeDCC.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.2.</b>
                        
                         dbcreator_encodeDCC
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.3" data-path="dbcreator/dbcreatorWorks.html">
            
                
                    <a href="../dbcreator/dbcreatorWorks.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.3.</b>
                        
                         How dbcreator works
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.4" data-path="dbcreator/dbcreatorFiltering.html">
            
                
                    <a href="../dbcreator/dbcreatorFiltering.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.4.</b>
                        
                         Filtering
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.5" data-path="dbcreator/dbcreatorStructure.html">
            
                
                    <a href="../dbcreator/dbcreatorStructure.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.5.</b>
                        
                         Database structure
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.6" data-path="dbcreator/dbcreatorBackground.html">
            
                
                    <a href="../dbcreator/dbcreatorBackground.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.6.</b>
                        
                         Background
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.7" data-path="dbcreator/dbcreatorCustom.html">
            
                
                    <a href="../dbcreator/dbcreatorCustom.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.7.</b>
                        
                         Custom data
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.1.8" data-path="dbcreator/dbcreatorFAQ.html">
            
                
                    <a href="../dbcreator/dbcreatorFAQ.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.8.</b>
                        
                         Dbcreator FAQ
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.2" data-path="optimizer/optimizer.html">
            
                
                    <a href="../optimizer/optimizer.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                         Optimizer module
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.2.1" data-path="optimizer/optimizerParallel.html">
            
                
                    <a href="../optimizer/optimizerParallel.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.1.</b>
                        
                         Parallelization
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.2.2" data-path="optimizer/optimizerFAQ.html">
            
                
                    <a href="../optimizer/optimizerFAQ.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.2.</b>
                        
                         Optimizer FAQ
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.3" data-path="server/server.html">
            
                
                    <a href="../server/server.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.3.</b>
                        
                         Server module
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter active" data-level="6.3.1" data-path="server/serverParallel.html">
            
                
                    <a href="../server/serverParallel.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.3.1.</b>
                        
                         Parallelization
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.3.2" data-path="server/serverFAQ.html">
            
                
                    <a href="../server/serverFAQ.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.3.2.</b>
                        
                         Server FAQ
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6.4" data-path="hypergeom4/hypergeom4.html">
            
                
                    <a href="../hypergeom4/hypergeom4.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.4.</b>
                        
                         Command line module
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.4.1" data-path="hypergeom4/hypergeom4Faq.html">
            
                
                    <a href="../hypergeom4/hypergeom4Faq.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.4.1.</b>
                        
                         Command line FAQ
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="7" data-path="hypergeom4/results.html">
            
                
                    <a href="../hypergeom4/results.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                         Results
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="7.1" data-path="hypergeom4/enrichment.html">
            
                
                    <a href="../hypergeom4/enrichment.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                         Enrichment results
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.2" data-path="hypergeom4/episimilarity.html">
            
                
                    <a href="../hypergeom4/episimilarity.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.</b>
                        
                         Epigenomic similarity results
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.3" data-path="hypergeom4/annotation.html">
            
                
                    <a href="../hypergeom4/annotation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.3.</b>
                        
                         Annotation results
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.4" data-path="hypergeom4/logs.html">
            
                
                    <a href="../hypergeom4/logs.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.4.</b>
                        
                         Logs and debug info
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.5" data-path="hypergeom4/resultsFaq.html">
            
                
                    <a href="../hypergeom4/resultsFaq.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.5.</b>
                        
                         Results FAQ
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8" data-path="references.html">
            
                
                    <a href="../references.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                         References
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 66.66666666666667%;min-width: 63.333333333333336%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../misc/Faq.html" title="FAQ" class="chapter done new-chapter" data-progress="1" style="left: 3.3333333333333335%;"></a>
    
        <a href="../misc/definitions.html" title="Definitions" class="chapter done new-chapter" data-progress="2" style="left: 6.666666666666667%;"></a>
    
        <a href="../misc/newsAndUpdates.html" title="News and Updates" class="chapter done new-chapter" data-progress="3" style="left: 10%;"></a>
    
        <a href="../installation/installation.html" title="Installation" class="chapter done new-chapter" data-progress="4" style="left: 13.333333333333334%;"></a>
    
        <a href="../installation/uninstallation.html" title="Uninstalling" class="chapter done new-chapter" data-progress="5" style="left: 16.666666666666668%;"></a>
    
        <a href="../installation/modules.html" title="Modules" class="chapter done new-chapter" data-progress="6" style="left: 20%;"></a>
    
        <a href="../dbcreator/dbcreator.html" title="Dbcreator module" class="chapter done " data-progress="6.1" style="left: 23.333333333333332%;"></a>
    
        <a href="../dbcreator/dbcreator_ucsc.html" title="dbcreator_ucsc" class="chapter done " data-progress="6.1.1" style="left: 26.666666666666668%;"></a>
    
        <a href="../dbcreator/dbcreator_encodeDCC.html" title="dbcreator_encodeDCC" class="chapter done " data-progress="6.1.2" style="left: 30%;"></a>
    
        <a href="../dbcreator/dbcreatorWorks.html" title="How dbcreator works" class="chapter done " data-progress="6.1.3" style="left: 33.333333333333336%;"></a>
    
        <a href="../dbcreator/dbcreatorFiltering.html" title="Filtering" class="chapter done " data-progress="6.1.4" style="left: 36.666666666666664%;"></a>
    
        <a href="../dbcreator/dbcreatorStructure.html" title="Database structure" class="chapter done " data-progress="6.1.5" style="left: 40%;"></a>
    
        <a href="../dbcreator/dbcreatorBackground.html" title="Background" class="chapter done " data-progress="6.1.6" style="left: 43.333333333333336%;"></a>
    
        <a href="../dbcreator/dbcreatorCustom.html" title="Custom data" class="chapter done " data-progress="6.1.7" style="left: 46.666666666666664%;"></a>
    
        <a href="../dbcreator/dbcreatorFAQ.html" title="Dbcreator FAQ" class="chapter done " data-progress="6.1.8" style="left: 50%;"></a>
    
        <a href="../optimizer/optimizer.html" title="Optimizer module" class="chapter done " data-progress="6.2" style="left: 53.333333333333336%;"></a>
    
        <a href="../optimizer/optimizerParallel.html" title="Parallelization" class="chapter done " data-progress="6.2.1" style="left: 56.666666666666664%;"></a>
    
        <a href="../optimizer/optimizerFAQ.html" title="Optimizer FAQ" class="chapter done " data-progress="6.2.2" style="left: 60%;"></a>
    
        <a href="../server/server.html" title="Server module" class="chapter done " data-progress="6.3" style="left: 63.333333333333336%;"></a>
    
        <a href="../server/serverParallel.html" title="Parallelization" class="chapter done " data-progress="6.3.1" style="left: 66.66666666666667%;"></a>
    
        <a href="../server/serverFAQ.html" title="Server FAQ" class="chapter  " data-progress="6.3.2" style="left: 70%;"></a>
    
        <a href="../hypergeom4/hypergeom4.html" title="Command line module" class="chapter  " data-progress="6.4" style="left: 73.33333333333333%;"></a>
    
        <a href="../hypergeom4/hypergeom4Faq.html" title="Command line FAQ" class="chapter  " data-progress="6.4.1" style="left: 76.66666666666667%;"></a>
    
        <a href="../hypergeom4/results.html" title="Results" class="chapter  new-chapter" data-progress="7" style="left: 80%;"></a>
    
        <a href="../hypergeom4/enrichment.html" title="Enrichment results" class="chapter  " data-progress="7.1" style="left: 83.33333333333333%;"></a>
    
        <a href="../hypergeom4/episimilarity.html" title="Epigenomic similarity results" class="chapter  " data-progress="7.2" style="left: 86.66666666666667%;"></a>
    
        <a href="../hypergeom4/annotation.html" title="Annotation results" class="chapter  " data-progress="7.3" style="left: 90%;"></a>
    
        <a href="../hypergeom4/logs.html" title="Logs and debug info" class="chapter  " data-progress="7.4" style="left: 93.33333333333333%;"></a>
    
        <a href="../hypergeom4/resultsFaq.html" title="Results FAQ" class="chapter  " data-progress="7.5" style="left: 96.66666666666667%;"></a>
    
        <a href="../references.html" title="References" class="chapter  new-chapter" data-progress="8" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_26">
                    
                        <h1 id="parallelizing-server-module">Parallelizing server module</h1>
<p>The <code>server</code> module can either be run on a single machine, or its tasks can be distributed among multiple machines. <a href="http://www.celeryproject.org/" target="_blank">Celery distributed task queue</a> with <a href="http://redis.io/" target="_blank">Redis</a> backend are used to parallelize the <code>server</code> module, set up similarly to the <a href="../optimizer/optimizerParallel.html">optimizer</a> module.</p>
<p>The host and the remote machines should have access to the identical <a href="../dbcreator/dbcreator_ucsc.html">databases</a>. The host and the remote machines should have access to <strong>THE SAME RESULTS FOLDER</strong>, best to be set up on a network drive.</p>
<h2 id="setting-up">Setting up</h2>
<p>The following installation steps assume:</p>
<ul>
<li>you have multiple Linux computers within the same network and selected one to be host computer;</li>
<li>GenomeRunner has been installed in <a href="../installation/installation.html">developer mode</a>;</li>
<li>The <a href="../dbcreator/dbcreator_ucsc.html">database</a> and the <a href="../dbcreator/dbcreatorBackground.html">background</a> have been created and mirrored among the computers.</li>
<li>The <code>results</code> folder is available to the host and the remote machines</li>
</ul>
<p>Check host computer&#39; IP address by running <code>ifconfig</code> command.</p>
<pre><code>$ ifconfig
eth0      Link encap:Ethernet  HWaddr 76:21:00:f4:56:c2  
          inet addr:10.84.XXX.XXX  Bcast:10.84.XXX.XXX  Mask:255.255.XXX.X
</code></pre><p>Note the inet addr:<strong>10.84.XXX.XXX</strong> number. Add this number in <code>celeryconfiguration.py</code> file on the host and remote computers:</p>
<pre><code>BROKER_URL = &quot;redis://10.84.XXX.XXX:{}/&quot;.format(redis_port) + db_num
</code></pre><p>Start the <code>optimizer</code> module on the host computer:</p>
<pre><code>python -m grsnp.server -g [org] -d [dir1],[dir2] -r [path/to/shared/results/folder] -w 0
</code></pre><p>The <strong>-w 0</strong> argument prohibits host computer to run workers locally. If sufficient CPU power is avaliable on the host machine, it is OK to set up <strong>-w</strong> argument to &quot;1&quot;.</p>
<p>Note the <strong>-r</strong> argument specifying path to the chared results folder.</p>
<p>The <strong>-d</strong> argument takes comma-separated paths to the databases.</p>
<p>Now, start celery worker on a remote machine:</p>
<pre><code>celery worker --app=grsnp.worker_hypergeom4 --d [dir1],[dir2] -r [path/to/shared/results/folder] --loglevel INFO -E
</code></pre><p>At that time, this worker start running optimization jobs. Start workers on other remote machines. The workers now will run different optimization jobs and their results will be assembled by the host computer.</p>
<h2 id="tips">Tips</h2>
<p>Monitor Celery workers on the host computer via web interface on <a href="http://localhost:5555" target="_blank">http://localhost:5555</a>:</p>
<pre><code>celery flower --broker=redis://localhost:7775/
</code></pre><p>Monitor Celery workers on the host computer via command line:</p>
<pre><code>celery inspect active --broker redis://localhost:7775/0
celery inspect active_queues -b redis://localhost:7775/0
</code></pre><p>Stop all workers:</p>
<pre><code>ps auxww | grep &#39;celery worker&#39; | awk &#39;{print $2}&#39; | xargs kill -9
</code></pre><p>Start redis command line utility:</p>
<pre><code>redis-cli
</code></pre><p>Get keys of all workers:</p>
<pre><code>redis-cli -h localhost -p 7775 keys \*
</code></pre><p>Get worker-specific messages from redis:</p>
<pre><code>redis-cli -h localhost -p 7775 keys \*
</code></pre>
                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../server/server.html" class="navigation navigation-prev " aria-label="Previous page: Server module"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../server/serverFAQ.html" class="navigation navigation-next " aria-label="Next page: Server FAQ"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
<script src="../gitbook/app.js"></script>

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
